select a.owner , a.table_name, a.column_name , b.num_rows , a.num_distinct , trunc(num_distinct / num_rows *100 , 2 )selectivity , 'Need Gather Histogram' notice
from dba_tab_col_statistics a , dba_tables b
where a.owner = 'JOHN'
and a.table_name = 'TEST'
and a.owner = b.owner 
and a.table_name = b.table_name
and num_distinct / num_rows < 0.01
and (a.owner, a.table_name , a.column_name) in(select r.name owner , o.name table_name , c.name column_name
                                                from sys.col_usage$ u , sys.obj$ o , sys.col$ c , sys.user$ r
                                                where o.obj# = u.obj#
                                                and c.obj# = u.obj#
                                                and c.col# = u.intcol#
                                                and r.name = 'JOHN'
                                                and o.name = 'TEST'
                                                and a.histogram = 'NONE');